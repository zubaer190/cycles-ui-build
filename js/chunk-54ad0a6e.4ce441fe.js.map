{"version":3,"sources":["webpack:///./src/views/maintanance/group-permissions.vue?861c","webpack:///./src/views/maintanance/group-permissions.vue","webpack:///./src/views/maintanance/group-permissions.vue?e26f"],"names":["class","style","title","content","value","permissions","header","field","readAll","binary","body","data","read","createAll","create","updateAll","update","deleteAll","delete","footer","icon","label","save","loading","setup","store","route","confirm","router","newVal","map","item","permissionsKeys","appKey","appKeyOptions","state","maintanance","appKeyList","filter","includes","processPermissionsList","items","rest","getUserGroupPermission","dispatch","params","id","then","catch","gId","securedFeatures","require","message","accept","push","name","finally","getAppKeyList","err","console","log","__exports__","render"],"mappings":"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","file":"js/chunk-54ad0a6e.4ce441fe.js","sourcesContent":["export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./group-permissions.vue?vue&type=style&index=0&id=696022b3&scoped=true&lang=css\"","<template>\r\n    <div class=\"card-container\">\r\n        <p-card style=\"max-width: 1000px;\">\r\n            <template #title>\r\n                Permissions\r\n            </template>\r\n            <template #content>\r\n                <p-data-table :value=\"permissions\">\r\n                    <p-column header=\"App\" field=\"label\"></p-column>\r\n\r\n                    <p-column header=\"Read\" field=\"read\" style=\"width: 80px\">\r\n                        <template #header>\r\n                            <p-checkbox\r\n                                v-model=\"readAll\"\r\n                                :binary=\"true\"\r\n                                class=\"p-mr-1\"\r\n                            />\r\n                        </template>\r\n                        <template #body=\"{data}\">\r\n                            <p-checkbox v-model=\"data.read\" :binary=\"true\" />\r\n                        </template>\r\n                    </p-column>\r\n\r\n                    <p-column header=\"Create\" field=\"create\" style=\"width: 80px\">\r\n                        <template #header>\r\n                            <p-checkbox\r\n                                v-model=\"createAll\"\r\n                                :binary=\"true\"\r\n                                class=\"p-mr-1\"\r\n                            />\r\n                        </template>\r\n                        <template #body=\"{data}\">\r\n                            <p-checkbox v-model=\"data.create\" :binary=\"true\" />\r\n                        </template>\r\n                    </p-column>\r\n\r\n                    <p-column header=\"Update\" field=\"update\" style=\"width: 80px\">\r\n                        <template #header>\r\n                            <p-checkbox\r\n                                v-model=\"updateAll\"\r\n                                :binary=\"true\"\r\n                                class=\"p-mr-1\"\r\n                            />\r\n                        </template>\r\n                        <template #body=\"{data}\">\r\n                            <p-checkbox v-model=\"data.update\" :binary=\"true\" />\r\n                        </template>\r\n                    </p-column>\r\n\r\n                    <p-column header=\"Delete\" field=\"delete\" style=\"width: 80px\">\r\n                        <template #header>\r\n                            <p-checkbox\r\n                                v-model=\"deleteAll\"\r\n                                :binary=\"true\"\r\n                                class=\"p-mr-1\"\r\n                            />\r\n                        </template>\r\n                        <template #body=\"{data}\">\r\n                            <p-checkbox v-model=\"data.delete\" :binary=\"true\" />\r\n                        </template>\r\n                    </p-column>\r\n                </p-data-table>\r\n            </template>\r\n            <template #footer>\r\n                <p-button\r\n                    icon=\"pi pi-check\"\r\n                    label=\"Save\"\r\n                    @click=\"save\"\r\n                    :loading=\"loading\"\r\n                />\r\n            </template>\r\n        </p-card>\r\n        <!-- <p-card style=\"width: 500px;\">\r\n            <template #title>Secured Features</template>\r\n            <template #content>\r\n            <div class=\"secured-features\">\r\n                <div v-for=\"(feature, index) in securedFeatures\" :key=\"index\" class=\"checkbox-container\">\r\n                    <label :for=\"feature.value\">{{ feature.label }}</label>\r\n                    <p-checkbox v-model=\"feature.read\" :binary=\"true\" :id=\"feature.value\"/>\r\n                </div>\r\n            </div>\r\n        </template>\r\n        </p-card> -->\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport { computed, onMounted, ref, watch } from \"vue\";\r\nimport { useStore } from \"vuex\";\r\nimport { useRoute, useRouter } from \"vue-router\";\r\nimport { useConfirm } from \"primevue/useconfirm\";\r\nexport default {\r\n    setup() {\r\n        const store = useStore();\r\n        const route = useRoute();\r\n        const permissions = ref([]);\r\n        const confirm = useConfirm();\r\n        const router = useRouter();\r\n\r\n        const readAll = ref(false);\r\n        const createAll = ref(false);\r\n        const updateAll = ref(false);\r\n        const deleteAll = ref(false);\r\n\r\n        watch(readAll, (newVal) => {\r\n            permissions.value = permissions.value.map((item) => {\r\n                return { ...item, read: newVal };\r\n            });\r\n        });\r\n\r\n        watch(createAll, (newVal) => {\r\n            permissions.value = permissions.value.map((item) => {\r\n                return { ...item, create: newVal };\r\n            });\r\n        });\r\n\r\n        watch(updateAll, (newVal) => {\r\n            permissions.value = permissions.value.map((item) => {\r\n                return { ...item, update: newVal };\r\n            });\r\n        });\r\n\r\n        watch(deleteAll, (newVal) => {\r\n            permissions.value = permissions.value.map((item) => {\r\n                return { ...item, delete: newVal };\r\n            });\r\n        });\r\n\r\n        const permissionsKeys = computed(() => {\r\n            return permissions.value.map((item) => item.appKey);\r\n        });\r\n        const appKeyOptions = computed(() => {\r\n            return store.state.maintanance.appKeyList.filter((item) => {\r\n                return !permissionsKeys.value.includes(item.value);\r\n            });\r\n        });\r\n\r\n        const processPermissionsList = (items) => {\r\n            const permissionsKeys = items.map((item) => item.appKey);\r\n            const rest = store.state.maintanance.appKeyList\r\n                .filter((item) => {\r\n                    return !permissionsKeys.includes(item.value);\r\n                })\r\n                .map((item) => {\r\n                    return {\r\n                        ...item,\r\n                        appKey: item.value,\r\n                        create: false,\r\n                        delete: false,\r\n                        read: false,\r\n                        update: false\r\n                    };\r\n                });\r\n            permissions.value = [...items, ...rest];\r\n        };\r\n\r\n        const getUserGroupPermission = () => {\r\n            store\r\n                .dispatch(\r\n                    \"maintanance/getUserGroupPermissions\",\r\n                    route.params.id\r\n                )\r\n                .then((data) => {\r\n                    processPermissionsList([...data.permissions]);\r\n                })\r\n                .catch(() => {\r\n                    processPermissionsList([]);\r\n                });\r\n        };\r\n\r\n        const loading = ref(false);\r\n        const save = () => {\r\n            loading.value = true;\r\n            store\r\n                .dispatch(\"maintanance/saveUserGroupPermission\", {\r\n                    gId: route.params.id,\r\n                    permissions: [...permissions.value],\r\n                    securedFeatures\r\n                })\r\n                .then((data) => {\r\n                    confirm.require({\r\n                        message: \"You need to re-login changes to take effect\",\r\n                        header: \"Re-login please\",\r\n                        icon: \"pi pi-info\",\r\n                        accept: () => {\r\n                            store.dispatch(\"logout\").then(() => {\r\n                                router.push({ name: \"Login\" });\r\n                            });\r\n                        }\r\n                    });\r\n                })\r\n                .finally(() => {\r\n                    loading.value = false;\r\n                });\r\n        };\r\n\r\n        const getAppKeyList = () => {\r\n            store\r\n                .dispatch(\"maintanance/getAppKeyList\")\r\n                .then()\r\n                .catch((err) => {\r\n                    console.log(err);\r\n                });\r\n        };\r\n\r\n        const securedFeatures = ref ([\r\n            {label: \"option1\", value: \"option1\", read: false},\r\n            {label: \"option2\", value: \"option2\", read: false},\r\n            {label: \"option3\", value: \"option3\", read: false},\r\n            {label: \"option4\", value: \"option4\", read: false},\r\n            {label: \"option5\", value: \"option5\", read: false},\r\n        ]);\r\n\r\n        onMounted(() => {\r\n            getAppKeyList();\r\n            getUserGroupPermission();\r\n        });\r\n\r\n        return {\r\n            permissions,\r\n            save,\r\n            loading,\r\n            appKeyOptions,\r\n            readAll,\r\n            createAll,\r\n            updateAll,\r\n            deleteAll,\r\n            securedFeatures\r\n        };\r\n    }\r\n};\r\n</script>\r\n<style scoped>\r\n.card-container {\r\n    display: flex;\r\n    justify-content: center;\r\n    gap: 40px;\r\n    flex-wrap: wrap;\r\n}\r\n/* .secured-features {\r\n    display: flex;\r\n    flex-direction: column;\r\n    gap: 15px;\r\n}\r\n.checkbox-container {\r\n    display: flex;\r\n    align-items: center; \r\n    gap: 60px;\r\n} */\r\n</style>\r\n","import { render } from \"./group-permissions.vue?vue&type=template&id=696022b3&scoped=true\"\nimport script from \"./group-permissions.vue?vue&type=script&lang=js\"\nexport * from \"./group-permissions.vue?vue&type=script&lang=js\"\n\nimport \"./group-permissions.vue?vue&type=style&index=0&id=696022b3&scoped=true&lang=css\"\n\nimport exportComponent from \"D:\\\\Workspace\\\\newlife\\\\vue-cycle-ui\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-696022b3\"]])\n\nexport default __exports__"],"sourceRoot":""}