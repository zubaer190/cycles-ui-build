{"version":3,"sources":["webpack:///./src/views/maintanance/group-permissions.vue","webpack:///./src/views/maintanance/group-permissions.vue?e26f"],"names":["style","title","content","value","permissions","header","field","readAll","binary","class","body","data","read","createAll","create","updateAll","update","deleteAll","delete","footer","icon","label","save","loading","setup","store","route","confirm","router","newVal","map","item","permissionsKeys","appKey","appKeyOptions","state","maintanance","appKeyList","filter","includes","processPermissionsList","items","rest","getUserGroupPermission","dispatch","params","id","then","catch","gId","require","message","accept","push","name","finally","getAppKeyList","err","console","log","__exports__","render"],"mappings":"0JAEyB,iB,yMADrB,eAqES,GArEDA,MAAA,+BAAmC,CAC5BC,MAAK,gBAAC,iBAEjB,C,MACWC,QAAO,gBACd,iBAsDe,CAtDf,eAsDe,GAtDAC,MAAO,EAAAC,aAAW,C,wBAC7B,iBAAgD,CAAhD,eAAgD,GAAtCC,OAAO,MAAMC,MAAM,UAE7B,eAWW,GAXDD,OAAO,OAAOC,MAAM,OAAON,MAAA,gB,CACtBK,OAAM,gBACb,iBAIE,CAJF,eAIE,G,WAHW,EAAAE,Q,qDAAA,EAAAA,QAAO,IACfC,QAAQ,EACTC,MAAM,U,2BAGHC,KAAI,gBACX,gBADcC,EACd,EADcA,KACd,MADkB,CAClB,eAAiD,G,WAA5BA,EAAKC,K,yCAALD,EAAKC,KAAI,GAAGJ,QAAQ,G,uDAIjD,eAWW,GAXDH,OAAO,SAASC,MAAM,SAASN,MAAA,gB,CAC1BK,OAAM,gBACb,iBAIE,CAJF,eAIE,G,WAHW,EAAAQ,U,qDAAA,EAAAA,UAAS,IACjBL,QAAQ,EACTC,MAAM,U,2BAGHC,KAAI,gBACX,gBADcC,EACd,EADcA,KACd,MADkB,CAClB,eAAmD,G,WAA9BA,EAAKG,O,yCAALH,EAAKG,OAAM,GAAGN,QAAQ,G,uDAInD,eAWW,GAXDH,OAAO,SAASC,MAAM,SAASN,MAAA,gB,CAC1BK,OAAM,gBACb,iBAIE,CAJF,eAIE,G,WAHW,EAAAU,U,qDAAA,EAAAA,UAAS,IACjBP,QAAQ,EACTC,MAAM,U,2BAGHC,KAAI,gBACX,gBADcC,EACd,EADcA,KACd,MADkB,CAClB,eAAmD,G,WAA9BA,EAAKK,O,yCAALL,EAAKK,OAAM,GAAGR,QAAQ,G,uDAInD,eAWW,GAXDH,OAAO,SAASC,MAAM,SAASN,MAAA,gB,CAC1BK,OAAM,gBACb,iBAIE,CAJF,eAIE,G,WAHW,EAAAY,U,qDAAA,EAAAA,UAAS,IACjBT,QAAQ,EACTC,MAAM,U,2BAGHC,KAAI,gBACX,gBADcC,EACd,EADcA,KACd,MADkB,CAClB,eAAmD,G,WAA9BA,EAAKO,O,yCAALP,EAAKO,OAAM,GAAGV,QAAQ,G,iFAKhDW,OAAM,gBACb,iBAKE,CALF,eAKE,GAJEC,KAAK,cACLC,MAAM,OACL,QAAO,EAAAC,KACPC,QAAS,EAAAA,S,sKAWX,GACXC,MADW,WAEP,IAAMC,EAAQ,iBACRC,EAAQ,iBACRtB,EAAc,eAAI,IAClBuB,EAAU,iBACVC,EAAS,iBAETrB,EAAU,gBAAI,GACdM,EAAY,gBAAI,GAChBE,EAAY,gBAAI,GAChBE,EAAY,gBAAI,GAEtB,eAAMV,GAAS,SAACsB,GACZzB,EAAYD,MAAQC,EAAYD,MAAM2B,KAAI,SAACC,GACvC,wCAAYA,GAAZ,IAAkBnB,KAAMiB,UAIhC,eAAMhB,GAAW,SAACgB,GACdzB,EAAYD,MAAQC,EAAYD,MAAM2B,KAAI,SAACC,GACvC,wCAAYA,GAAZ,IAAkBjB,OAAQe,UAIlC,eAAMd,GAAW,SAACc,GACdzB,EAAYD,MAAQC,EAAYD,MAAM2B,KAAI,SAACC,GACvC,wCAAYA,GAAZ,IAAkBf,OAAQa,UAIlC,eAAMZ,GAAW,SAACY,GACdzB,EAAYD,MAAQC,EAAYD,MAAM2B,KAAI,SAACC,GACvC,wCAAYA,GAAZ,IAAkBb,OAAQW,UAIlC,IAAMG,EAAkB,gBAAS,WAC7B,OAAO5B,EAAYD,MAAM2B,KAAI,SAACC,GAAD,OAAUA,EAAKE,aAE1CC,EAAgB,gBAAS,WAC3B,OAAOT,EAAMU,MAAMC,YAAYC,WAAWC,QAAO,SAACP,GAC9C,OAAQC,EAAgB7B,MAAMoC,SAASR,EAAK5B,aAI9CqC,EAAyB,SAACC,GAC5B,IAAMT,EAAkBS,EAAMX,KAAI,SAACC,GAAD,OAAUA,EAAKE,UAC3CS,EAAOjB,EAAMU,MAAMC,YAAYC,WAChCC,QAAO,SAACP,GACL,OAAQC,EAAgBO,SAASR,EAAK5B,UAEzC2B,KAAI,SAACC,GACF,wCACOA,GADP,IAEIE,OAAQF,EAAK5B,MACbW,QAAQ,EACRI,QAAQ,EACRN,MAAM,EACNI,QAAQ,OAGpBZ,EAAYD,MAAZ,yBAAwBsC,GAAxB,eAAkCC,KAGhCC,EAAyB,WAC3BlB,EACKmB,SACG,sCACAlB,EAAMmB,OAAOC,IAEhBC,MAAK,SAACpC,GACH6B,EAAuB,eAAI7B,EAAKP,iBAEnC4C,OAAM,WACHR,EAAuB,QAI7BjB,EAAU,gBAAI,GACdD,EAAO,WACTC,EAAQpB,OAAQ,EAChBsB,EACKmB,SAAS,sCAAuC,CAC7CK,IAAKvB,EAAMmB,OAAOC,GAClB1C,YAAa,eAAIA,EAAYD,SAEhC4C,MAAK,SAACpC,GACHgB,EAAQuB,QAAQ,CACZC,QAAS,8CACT9C,OAAQ,kBACRe,KAAM,aACNgC,OAAQ,WACJ3B,EAAMmB,SAAS,UAAUG,MAAK,WAC1BnB,EAAOyB,KAAK,CAAEC,KAAM,mBAKnCC,SAAQ,WACLhC,EAAQpB,OAAQ,MAItBqD,EAAgB,WAClB/B,EACKmB,SAAS,6BACTG,OACAC,OAAM,SAACS,GACJC,QAAQC,IAAIF,OASxB,OALA,gBAAU,WACND,IACAb,OAGG,CACHvC,cACAkB,OACAC,UACAW,gBACA3B,UACAM,YACAE,YACAE,e,qBCvMZ,MAAM2C,EAA2B,IAAgB,EAAQ,CAAC,CAAC,SAASC,KAErD","file":"js/chunk-2d0e66c8.5140ef66.js","sourcesContent":["<template>\n    <p-card style=\"width: 600px; margin: auto;\">\n        <template #title>\n            Permissions\n        </template>\n        <template #content>\n            <p-data-table :value=\"permissions\">\n                <p-column header=\"App\" field=\"label\"></p-column>\n\n                <p-column header=\"Read\" field=\"read\" style=\"width: 80px\">\n                    <template #header>\n                        <p-checkbox\n                            v-model=\"readAll\"\n                            :binary=\"true\"\n                            class=\"p-mr-1\"\n                        />\n                    </template>\n                    <template #body=\"{data}\">\n                        <p-checkbox v-model=\"data.read\" :binary=\"true\" />\n                    </template>\n                </p-column>\n\n                <p-column header=\"Create\" field=\"create\" style=\"width: 80px\">\n                    <template #header>\n                        <p-checkbox\n                            v-model=\"createAll\"\n                            :binary=\"true\"\n                            class=\"p-mr-1\"\n                        />\n                    </template>\n                    <template #body=\"{data}\">\n                        <p-checkbox v-model=\"data.create\" :binary=\"true\" />\n                    </template>\n                </p-column>\n\n                <p-column header=\"Update\" field=\"update\" style=\"width: 80px\">\n                    <template #header>\n                        <p-checkbox\n                            v-model=\"updateAll\"\n                            :binary=\"true\"\n                            class=\"p-mr-1\"\n                        />\n                    </template>\n                    <template #body=\"{data}\">\n                        <p-checkbox v-model=\"data.update\" :binary=\"true\" />\n                    </template>\n                </p-column>\n\n                <p-column header=\"Delete\" field=\"delete\" style=\"width: 80px\">\n                    <template #header>\n                        <p-checkbox\n                            v-model=\"deleteAll\"\n                            :binary=\"true\"\n                            class=\"p-mr-1\"\n                        />\n                    </template>\n                    <template #body=\"{data}\">\n                        <p-checkbox v-model=\"data.delete\" :binary=\"true\" />\n                    </template>\n                </p-column>\n            </p-data-table>\n        </template>\n        <template #footer>\n            <p-button\n                icon=\"pi pi-check\"\n                label=\"Save\"\n                @click=\"save\"\n                :loading=\"loading\"\n            />\n        </template>\n    </p-card>\n</template>\n\n<script>\nimport { computed, onMounted, reactive, ref, watch } from \"vue\";\nimport { useStore } from \"vuex\";\nimport { useRoute, useRouter } from \"vue-router\";\nimport { useConfirm } from \"primevue/useconfirm\";\nexport default {\n    setup() {\n        const store = useStore();\n        const route = useRoute();\n        const permissions = ref([]);\n        const confirm = useConfirm();\n        const router = useRouter();\n\n        const readAll = ref(false);\n        const createAll = ref(false);\n        const updateAll = ref(false);\n        const deleteAll = ref(false);\n\n        watch(readAll, (newVal) => {\n            permissions.value = permissions.value.map((item) => {\n                return { ...item, read: newVal };\n            });\n        });\n\n        watch(createAll, (newVal) => {\n            permissions.value = permissions.value.map((item) => {\n                return { ...item, create: newVal };\n            });\n        });\n\n        watch(updateAll, (newVal) => {\n            permissions.value = permissions.value.map((item) => {\n                return { ...item, update: newVal };\n            });\n        });\n\n        watch(deleteAll, (newVal) => {\n            permissions.value = permissions.value.map((item) => {\n                return { ...item, delete: newVal };\n            });\n        });\n\n        const permissionsKeys = computed(() => {\n            return permissions.value.map((item) => item.appKey);\n        });\n        const appKeyOptions = computed(() => {\n            return store.state.maintanance.appKeyList.filter((item) => {\n                return !permissionsKeys.value.includes(item.value);\n            });\n        });\n\n        const processPermissionsList = (items) => {\n            const permissionsKeys = items.map((item) => item.appKey);\n            const rest = store.state.maintanance.appKeyList\n                .filter((item) => {\n                    return !permissionsKeys.includes(item.value);\n                })\n                .map((item) => {\n                    return {\n                        ...item,\n                        appKey: item.value,\n                        create: false,\n                        delete: false,\n                        read: false,\n                        update: false\n                    };\n                });\n            permissions.value = [...items, ...rest];\n        };\n\n        const getUserGroupPermission = () => {\n            store\n                .dispatch(\n                    \"maintanance/getUserGroupPermissions\",\n                    route.params.id\n                )\n                .then((data) => {\n                    processPermissionsList([...data.permissions]);\n                })\n                .catch(() => {\n                    processPermissionsList([]);\n                });\n        };\n\n        const loading = ref(false);\n        const save = () => {\n            loading.value = true;\n            store\n                .dispatch(\"maintanance/saveUserGroupPermission\", {\n                    gId: route.params.id,\n                    permissions: [...permissions.value]\n                })\n                .then((data) => {\n                    confirm.require({\n                        message: \"You need to re-login changes to take effect\",\n                        header: \"Re-login please\",\n                        icon: \"pi pi-info\",\n                        accept: () => {\n                            store.dispatch(\"logout\").then(() => {\n                                router.push({ name: \"Login\" });\n                            });\n                        }\n                    });\n                })\n                .finally(() => {\n                    loading.value = false;\n                });\n        };\n\n        const getAppKeyList = () => {\n            store\n                .dispatch(\"maintanance/getAppKeyList\")\n                .then()\n                .catch((err) => {\n                    console.log(err);\n                });\n        };\n\n        onMounted(() => {\n            getAppKeyList();\n            getUserGroupPermission();\n        });\n\n        return {\n            permissions,\n            save,\n            loading,\n            appKeyOptions,\n            readAll,\n            createAll,\n            updateAll,\n            deleteAll\n        };\n    }\n};\n</script>\n","import { render } from \"./group-permissions.vue?vue&type=template&id=1c3410bf\"\nimport script from \"./group-permissions.vue?vue&type=script&lang=js\"\nexport * from \"./group-permissions.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"/home/saif/Projects/vue-cycle-ui/node_modules/vue-loader-v16/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"sourceRoot":""}